package OrangeHRMApplicationTesting;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Properties;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;

import com.Utility.Log;



public class TestngAddEmployee extends BaseTest{

	FileInputStream PropertiesFile;
	Properties properties;
	
	@Test(priority=1,description="Validating OrangeHrm Loginpage using Lginpanel Text")
	public void LoginpanelText() throws IOException 
	{
		
		FileInputStream file=new FileInputStream("C:\\Users\\NIHARIKA\\Desktop\\Neha\\OrangeHRMApplication\\src\\OrangeHRMTestDatafiles\\AddEmployee.xlsx");
		XSSFWorkbook WorkBook = new XSSFWorkbook(file);
		XSSFSheet TestdataSheet = WorkBook.getSheet("Sheet1");
		
		PropertiesFile = new FileInputStream("C:\\Users\\NIHARIKA\\Desktop\\Neha\\OrangeHRMApplication\\src\\com\\config\\OrangeHRMproperties.properties");
		properties = new Properties();
		properties.load(PropertiesFile);
		
		Row testdatarow = 	TestdataSheet.getRow(1);
		Cell testdatarowofcell = testdatarow.getCell(0);
		
	    String TestDataLoginpanel = testdatarowofcell.getStringCellValue();
		
	    String ExpectedLoginpageText = TestDataLoginpanel;
	    Log.info("The login page should contains text -"+ExpectedLoginpageText);
	    
	  //<div id="logInPanelHeading">LOGIN Panel</div>
		By Loginpanelproperty = By.id(properties.getProperty("logInPanelHeadinglogInPanelHeading"));
		WebElement loginpanel = driver.findElement(Loginpanelproperty);
		
		String ActualLoginpanelText = loginpanel.getText();
		Cell Loginpanel = testdatarow.createCell(1);
		Loginpanel.setCellValue(ActualLoginpanelText);	   

		Log.info("The Actual login panel should cantains - "+ActualLoginpanelText);
		if(ActualLoginpanelText.equals(ExpectedLoginpageText)) 
		{
			
			Log.info(ActualLoginpanelText);
			Cell loginpaneltestresult = testdatarow.createCell(2);
			loginpaneltestresult.setCellValue("Successfully navigated to login page - PASS");	
		}
		else
		{
			Log.info("Failed navigated to login page - FAIL");
			Cell loginpaneltestresult = testdatarow.createCell(2);
			loginpaneltestresult.setCellValue("Successfully navigated to login page - FAIL");	
	
		}
		
		FileOutputStream OHRMLoginTestResult = new FileOutputStream("C:\\Users\\NIHARIKA\\Desktop\\Neha\\OrangeHRMApplication\\src\\OrangeHRMTestDatafiles\\AddEmployee.xlsx");
    	WorkBook.write(OHRMLoginTestResult);
	}
	@Test(priority=2,description="Validating Ohrm Loginpage using LoginpageTitle")
	public void OHRMTitle() throws IOException
	{
	
		FileInputStream file=new FileInputStream("C:\\Users\\NIHARIKA\\Desktop\\Neha\\OrangeHRMApplication\\src\\OrangeHRMTestDatafiles\\AddEmployee.xlsx");
		XSSFWorkbook WorkBook = new XSSFWorkbook(file);
		XSSFSheet TestdataSheet = WorkBook.getSheet("Sheet1");
		
		Row testdatarow = 	TestdataSheet.getRow(1);
		Cell testdatarowofcell = testdatarow.getCell(3);
		String LoginpageTitletestData = testdatarowofcell.getStringCellValue();
		
		String ExpectedLoginpageTitle = LoginpageTitletestData;
		Log.info("The login page should contains Title -"+ExpectedLoginpageTitle);
		
		//<div id="logInPanelHeading">LOGIN Panel</div>
		String ActualLoginpageTitle = driver.getTitle();
		Cell loginpanel = testdatarow.createCell(4);
		loginpanel.setCellValue(ActualLoginpageTitle);
		
		Log.info("The Actual login panel should cantains - "+ActualLoginpageTitle);
		if(ActualLoginpageTitle.equals(ExpectedLoginpageTitle))
		{
		
			Log.info("Successfully navigated to login page - PASS");
			Cell loginPanelTestresult = testdatarow.createCell(5);
			loginPanelTestresult.setCellValue("Successfully navigated to login page - PASS");
		}
		else
		{
			Log.info("Successfully navigated to login page - FAIL");
			Cell loginPanelTestresult = testdatarow.createCell(5);
			loginPanelTestresult.setCellValue("Successfully navigated to login page - FAIL");
		
		}
		
	}
}
